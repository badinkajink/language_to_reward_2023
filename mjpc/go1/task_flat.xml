<mujoco model="Quadruped">
  <!-- <include file="../common.xml"/> -->
  <visual>
    <headlight ambient=".4 .4 .4" diffuse=".8 .8 .8" specular="0.1 0.1 0.1"/>
    <map znear=".01"/>
    <quality shadowsize="2048"/>
    <global elevation="-15"/>
  </visual>

  <asset>
    <texture name="blue_grid" type="2d" builtin="checker" rgb1=".02 .14 .44" rgb2=".27 .55 1" width="300" height="300" mark="edge" markrgb="1 1 1"/>
    <material name="blue_grid" texture="blue_grid" texrepeat="1 1" texuniform="true" reflectance=".2"/>

    <texture name="grey_grid" type="2d" builtin="checker" rgb1=".26 .26 .26" rgb2=".6 .6 .6" width="300" height="300" mark="edge" markrgb="1 1 1"/>
    <material name="grey_grid" texture="grey_grid" texrepeat="1 1" texuniform="true" reflectance=".2"/>
    <texture name="skybox" type="skybox" builtin="gradient" rgb1=".66 .79 1" rgb2=".9 .91 .93" width="800" height="800"/>

    <material name="self" rgba=".7 .5 .3 1"/>
    <material name="self_default" rgba=".7 .5 .3 1"/>
    <material name="self_highlight" rgba="0 .5 .3 1"/>
    <material name="effector" rgba=".7 .4 .2 1"/>
    <material name="effector_default" rgba=".7 .4 .2 1"/>
    <material name="effector_highlight" rgba="0 .5 .3 1"/>
    <material name="decoration" rgba=".2 .6 .3 1"/>
    <material name="eye" rgba="0 .2 1 1"/>
    <material name="target" rgba=".6 .3 .3 1"/>
    <material name="target_default" rgba=".6 .3 .3 1"/>
    <material name="target_highlight" rgba=".6 .3 .3 .4"/>
    <material name="site" rgba=".5 .5 .5 .3"/>
  </asset>
  
  <size memory="1M"/>

  <custom>
    <!-- agent -->
    <text name="task_transition" data="Quadruped|Biped|Walk|Scramble|Flip" />
    <numeric name="agent_planner" data="2 " />
    <numeric name="agent_horizon" data="0.35" />
    <numeric name="agent_timestep" data="0.01" />
    <numeric name="agent_integrator" data="3" />
    <numeric name="sampling_spline_points" data="3" />
    <numeric name="sampling_trajectories" data="60"/>
    <numeric name="sampling_exploration" data="0.04" />
    <numeric name="gradient_spline_points" data="5" />

    <!-- residual -->
    <numeric name="residual_TargetBodyHeight" data="0.292 0 1" />
    <numeric name="residual_GoalPositionX" data="0.0 -4 4" />
    <numeric name="residual_GoalPositionY" data="0.0 -4 4" />
    <numeric name="residual_TargetHeading" data="0.0 -3.142 3.142" />
    <numeric name="residual_TargetPitch" data="0.0 -1.571 1.571" />
    <numeric name="residual_TargetRoll" data="0.0 -3.142 3.142" />
    <numeric name="residual_TargetForwardVelocity" data="0.0 -3 3" />
    <numeric name="residual_TargetSidewaysVelocity" data="0.0 -3 3" />
    <numeric name="residual_TargetUpwardVelocity" data="0.0 -3 3" />
    <numeric name="residual_TargetTurningVelocity" data="0.0 -3 3" />
    <numeric name="residual_TargetRollVelocity" data="0.0 -3 3" />

    <!-- how much to weigh each foot for computing balance. -->
    <numeric name="residual_FLBalance" data="1 0 1" />
    <numeric name="residual_HLBalance" data="1 0 1" />
    <numeric name="residual_FRBalance" data="1 0 1" />
    <numeric name="residual_HRBalance" data="1 0 1" />

    <!-- gait-related parameters -->
    <numeric name="residual_FLXDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_FLYDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_FLZDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_FLSteppingFrequency" data="0.0 0 3" />
    <numeric name="residual_FLGroundToAirRatio" data="0.0 0 1" />
    <numeric name="residual_FLPhaseOffset" data="0.0 0 1" />
    <numeric name="residual_FLAmplitudesVertical" data="0.0 0 1" />
    <numeric name="residual_FLAmplitudesForward" data="0.0 -1 1" />
    <numeric name="residual_HLXDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_HLYDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_HLZDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_HLSteppingFrequency" data="0.0 0 3" />
    <numeric name="residual_HLGroundToAirRatio" data="0.0 0 1" />
    <numeric name="residual_HLPhaseOffset" data="0.0 0 1" />
    <numeric name="residual_HLAmplitudesVertical" data="0.0 0 1" />
    <numeric name="residual_HLAmplitudesForward" data="0.0 -1 1" />
    <numeric name="residual_FRXDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_FRYDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_FRZDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_FRSteppingFrequency" data="0.0 0 3" />
    <numeric name="residual_FRGroundToAirRatio" data="0.0 0 1" />
    <numeric name="residual_FRPhaseOffset" data="0.0 0 1" />
    <numeric name="residual_FRAmplitudesVertical" data="0.0 0 1" />
    <numeric name="residual_FRAmplitudesForward" data="0.0 -1 1" />
    <numeric name="residual_HRXDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_HRYDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_HRZDistFromNominal" data="0.0 -1 1" />
    <numeric name="residual_HRSteppingFrequency" data="0.0 0 3" />
    <numeric name="residual_HRGroundToAirRatio" data="0.0 0 1" />
    <numeric name="residual_HRPhaseOffset" data="0.0 0 1" />
    <numeric name="residual_HRAmplitudesVertical" data="0.0 0 1" />
    <numeric name="residual_HRAmplitudesForward" data="0.0 -1 1" />

    <numeric name="residual_q1" data="0.0 -3 3" />
    <numeric name="residual_q2" data="0.0 -3 3" />
    <numeric name="residual_q3" data="0.0 -3 3" />
    <numeric name="residual_q4" data="0.0 -3 3" />
    <numeric name="residual_q5" data="0.0 -3 3" />
    <numeric name="residual_q6" data="0.0 -3 3" />
    <numeric name="residual_q7" data="0.0 -3 3" />
    <numeric name="residual_q8" data="0.0 -3 3" />
    <numeric name="residual_q9" data="0.0 -3 3" />
    <numeric name="residual_q10" data="0.0 -3 3" />
    <numeric name="residual_q11" data="0.0 -3 3" />
    <numeric name="residual_q12" data="0.0 -3 3" />

    <numeric name="residual_select_Gait" data="0"/>
    <text name="residual_list_Gait" data="Stand|Walk|Trot|Canter|Gallop"/>
    <numeric name="residual_select_Gait switch" data="1"/>
    <text name="residual_list_Gait switch" data="Manual|Automatic"/>
    <numeric name="residual_Cadence" data="2 0 4" />
    <numeric name="residual_Amplitude" data=".06 0 0.2" />
    <numeric name="residual_Duty ratio" data="0 0 1"/>
    <numeric name="residual_Walk speed" data="0 0 4"/>
    <numeric name="residual_Walk turn" data="0 -2 2"/>
    <numeric name="residual_select_Flip dir" data="0"/>
    <text name="residual_list_Flip dir" data="Back Flip|Front Flip"/>
    <numeric name="residual_select_Biped type" data="0"/>
    <text name="residual_list_Biped type" data="Foot Stand|Hand Stand"/>
    <numeric name="residual_Heading" data="0 -3.14 3.14" />

    <!-- estimator -->
    <numeric name="estimator" data="0" />
    <numeric name="estimator_sensor_start" data="9" />
    <numeric name="estimator_number_sensor" data="21" />
    <numeric name="estimator_timestep" data="0.005" />
    <numeric name="batch_configuration_length" data="3" />
    <numeric name="batch_scale_prior" data="1.0e-3" />
  </custom>

  <visual>
    <headlight diffuse="0.6 0.6 0.6"  ambient="0.3 0.3 0.3" specular="0 0 0"/>
    <global azimuth="-90"/>
  </visual>

  <statistic extent="1" center="0 0 .3"/>

  <default>
    <default class="torque">
      <general gainprm="40" ctrllimited="true" ctrlrange="-1 1"/>
    </default>
    <default class="task">
      <site rgba="1 0 0 1" size=".02" group="5"/>
      <default class="flight">
        <site rgba="1 .3 .3 1" size="0.019" group="5"/>
      </default>
      <default class="stance">
        <site rgba=".3 1 .3 1" size=".018" group="4"/>
      </default>
    </default>
    <default class="prop">
      <geom type="box" rgba="0 0.4 1 1"/>
    </default>
  </default>

  <include file="go1.xml" />

  <actuator>
    <general class="torque" name="FR_hip" joint="FR_hip_joint"/>
    <general class="torque" name="FR_thigh" joint="FR_thigh_joint"/>
    <general class="torque" name="FR_calf" joint="FR_calf_joint"/>
    <general class="torque" name="FL_hip" joint="FL_hip_joint"/>
    <general class="torque" name="FL_thigh" joint="FL_thigh_joint"/>
    <general class="torque" name="FL_calf" joint="FL_calf_joint"/>
    <general class="torque" name="RR_hip" joint="RR_hip_joint"/>
    <general class="torque" name="RR_thigh" joint="RR_thigh_joint"/>
    <general class="torque" name="RR_calf" joint="RR_calf_joint"/>
    <general class="torque" name="RL_hip" joint="RL_hip_joint"/>
    <general class="torque" name="RL_thigh" joint="RL_thigh_joint"/>
    <general class="torque" name="RL_calf" joint="RL_calf_joint"/>
  </actuator>

  <sensor>
    <!-- Torso tracking -->
    <user name="BodyHeight" dim="1" user="6 0 0 3 0.1" />
    <user name="BodyXYPos" dim="2" user="2 0.0 0 0.5 0.1" />
    <user name="Heading" dim="2" user="0 0.0 0 .3" />
    <user name="Pitch" dim="1" user="6 0.0 0 3 0.05" />
    <user name="Roll" dim="2" user="6 0.0 0 3 0.05" />
    <user name="Forward_Velocity" dim="1" user="2 0.0 0 0.5 0.1" />
    <user name="Sideways_Velocity" dim="1" user="2 0.0 0 0.5 0.1" />
    <user name="Upward_Velocity" dim="1" user="2 0.0 0 0.5 0.1" />
    <user name="Roll_Velocity" dim="1" user="2 0.0 0 0.5 0.1" />
    <user name="Turning_Velocity" dim="1" user="2 0.0 0 0.5 0.1" />

    <!-- Feet tracking -->
    <user name="FL_forward" dim="1" user="2 0.0 0 1.0 0.1" />
    <user name="HL_forward" dim="1" user="2 0.0 0 1.0 0.1" />
    <user name="FR_forward" dim="1" user="2 0.0 0 1.0 0.1" />
    <user name="HR_forward" dim="1" user="2 0.0 0 1.0 0.1" />

    <user name="FL_inward" dim="1" user="2 0.0 0 1.0 0.1" />
    <user name="HL_inward" dim="1" user="2 0.0 0 1.0 0.1" />
    <user name="FR_inward" dim="1" user="2 0.0 0 1.0 0.1" />
    <user name="HR_inward" dim="1" user="2 0.0 0 1.0 0.1" />

    <user name="FL_upward" dim="1" user="2 0.0 0 2.0 0.1" />
    <user name="HL_upward" dim="1" user="2 0.0 0 2.0 0.1" />
    <user name="FR_upward" dim="1" user="2 0.0 0 2.0 0.1" />
    <user name="HR_upward" dim="1" user="2 0.0 0 2.0 0.1" />

    <!-- Feet gait tracking -->
    <user name="FL_stepping_vertical" dim="1" user="2 0.0 0 2 0.1" />
    <user name="FL_stepping_horizontal" dim="1" user="2 0.0 0 0.5 0.1" />
    <user name="HL_stepping_vertical" dim="1" user="2 0.0 0 2.0 0.1" />
    <user name="HL_stepping_horizontal" dim="1" user="2 0.0 0 0.5 0.1" />
    <user name="FR_stepping_vertical" dim="1" user="2 0.0 0 2.0 0.1" />
    <user name="FR_stepping_horizontal" dim="1" user="2 0.0 0 0.5 0.1" />
    <user name="HR_stepping_vertical" dim="1" user="2 0.0 0 2.0 0.1" />
    <user name="HR_stepping_horizontal" dim="1" user="2 0.0 0 0.5 0.1" />

    <user name="PoseTracking" dim="12" user="0 0.0 0.0 5.0" />
    <user name="act_dot" dim="12" user="0 2e-5 0 1e-4" />

    <!-- cost -->
    <user name="Upright" dim="3" user="6 1 0 3 0.05" />
    <user name="Height" dim="1" user="6 1 0 3 0.04" />
    <user name="Position" dim="3" user="2 0.2 0 0.5 0.1" />
    <user name="Gait" dim="4" user="6 2 0 10 0.03" />
    <user name="Balance" dim="2" user="2 0.2 0 0.3 0.1" />
    <user name="Effort" dim="12" user="0 0.03 0.0 0.1" />
    <user name="Posture" dim="12" user="0 0.02 0.0 0.1" />
    <user name="Orientation" dim="2" user="0 0 0 .03" />
    <user name="Angmom" dim="3" user="0 0 0 .03" />

    <!-- estimator measurements -->
    <framepos name="torso_pos" objtype="site" objname="torso" />
    <framepos name="FR_pos" objtype="site" objname="FR" />
    <framepos name="FL_pos" objtype="site" objname="FL" />
    <framepos name="HR_pos" objtype="site" objname="HR" />
    <framepos name="HL_pos" objtype="site" objname="HL" />

    <jointpos name="pos_FR_hip_joint" joint="FR_hip_joint" />
    <jointpos name="pos_FR_thigh_joint" joint="FR_thigh_joint" />
    <jointpos name="pos_FR_calf_joint" joint="FR_calf_joint" />
    <jointpos name="pos_FL_hip_joint" joint="FL_hip_joint" />
    <jointpos name="pos_FL_thigh_joint" joint="FL_thigh_joint" />
    <jointpos name="pos_FL_calf_joint" joint="FL_calf_joint" />
    <jointpos name="pos_RR_hip_joint" joint="RR_hip_joint" />
    <jointpos name="pos_RR_thigh_joint" joint="RR_thigh_joint" />
    <jointpos name="pos_RR_calf_joint" joint="RR_calf_joint" />
    <jointpos name="pos_RL_hip_joint" joint="RL_hip_joint" />
    <jointpos name="pos_RL_thigh_joint" joint="RL_thigh_joint" />
    <jointpos name="pos_RL_calf_joint" joint="RL_calf_joint" />

    <touch name="FR_touch" site="FR"/>
    <touch name="FL_touch" site="FL"/>
    <touch name="HR_touch" site="HR"/>
    <touch name="HL_touch" site="HL"/>

    <!-- trace -->
    <framepos      name="trace0" objtype="site" objname="head"/>

    <!-- residual -->
    <subtreecom    name="torso_subtreecom" body="trunk"/>
    <subtreelinvel name="torso_subtreelinvel" body="trunk"/>
    <subtreelinvel name="torso_angmom" body="trunk"/>
    <framequat     name="torso_subtreequat" objtype="xbody" objname="trunk"/>
    <gyro name="torso_angvel" site="torso"/>
    <framezaxis    name="torso_up" objtype="xbody" objname="trunk"/>
    <framexaxis    name="torso_forward" objtype="xbody" objname="trunk"/>
    <framepos      name="body" objtype="site" objname="torso"/>

    <framepos   name="FLpos" objtype="site" objname="FR"/>
    <framepos   name="RLpos" objtype="site" objname="HL"/>
    <framepos   name="FRpos" objtype="site" objname="FR"/>
    <framepos   name="RRpos" objtype="site" objname="HR"/>
    
    <framelinvel   name="FLvel" objtype="site" objname="FR"/>
    <framelinvel   name="RLvel" objtype="site" objname="HL"/>
    <framelinvel   name="FRvel" objtype="site" objname="FR"/>
    <framelinvel   name="RRvel" objtype="site" objname="HR"/>

  </sensor>

  <keyframe>
    <!-- <key name="home"
         qpos="0 0 0.26
               1 0 0 0
               -0.000341931 0.0181576 -0.0268335
               0.00160968 0.0247957 -0.0270045
               0.00191398 -0.033048 -0.0675298
               -0.00199489 -0.0374747 -0.0681862"/> -->
    <key name="home" 
      qpos="0 0 0.27 
            1 0 0 0 
            0 0.9 -1.8 
            0 0.9 -1.8 
            0 0.9 -1.8 
            0 0.9 -1.8" />
    <key name="crouch"
         qpos="-0.0501827 0.00107117 0.143925
               1 0 0 0
               0 0 -0.5
               0 0 -0.5
               0 0 -0.5
               0 0 -0.5"/>

  </keyframe>
</mujoco>
